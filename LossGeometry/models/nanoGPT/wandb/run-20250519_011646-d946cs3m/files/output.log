step 0: train loss 10.8634, val loss 10.8635

--- Performing spectral analysis at iteration 0 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 0
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011651
Analysis data saved to out-spectral/20250519_011651/20250519_011651_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_011651/20250519_011651_analysis_data.h5

--- Performing initial spectral analysis ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Completed initial spectral analysis
iter 0: loss 10.8637, time 4688.95ms, mfu -100.00%
iter 10: loss 10.5782, time 18.43ms, mfu 0.34%
iter 20: loss 10.2702, time 12.97ms, mfu 0.35%
iter 30: loss 10.0823, time 12.01ms, mfu 0.37%
iter 40: loss 9.7521, time 12.83ms, mfu 0.38%
iter 50: loss 9.3295, time 11.44ms, mfu 0.39%
iter 60: loss 8.8852, time 16.81ms, mfu 0.39%
iter 70: loss 8.3314, time 16.83ms, mfu 0.39%
iter 80: loss 7.8119, time 16.64ms, mfu 0.39%
iter 90: loss 7.3693, time 24.08ms, mfu 0.37%
step 100: train loss 7.0041, val loss 7.0382
saving checkpoint to out-spectral
iter 100: loss 7.0620, time 2395.09ms, mfu 0.34%
iter 110: loss 6.8228, time 43.08ms, mfu 0.32%
iter 120: loss 6.4933, time 34.09ms, mfu 0.30%
iter 130: loss 6.4354, time 19.60ms, mfu 0.31%
iter 140: loss 6.1686, time 34.61ms, mfu 0.29%
iter 150: loss 6.0850, time 24.53ms, mfu 0.29%
iter 160: loss 5.9227, time 24.53ms, mfu 0.29%
iter 170: loss 5.8624, time 25.60ms, mfu 0.28%
iter 180: loss 5.8246, time 17.62ms, mfu 0.29%
iter 190: loss 5.5763, time 23.82ms, mfu 0.29%
step 200: train loss 5.5584, val loss 5.6864
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 200 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 200
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011702
Analysis data saved to out-spectral/20250519_011702/20250519_011702_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_011702/20250519_011702_analysis_data.h5
iter 200: loss 5.6011, time 3791.56ms, mfu 0.26%
iter 210: loss 5.4578, time 14.33ms, mfu 0.27%
iter 220: loss 5.3545, time 17.58ms, mfu 0.28%
iter 230: loss 5.4936, time 21.00ms, mfu 0.28%
iter 240: loss 5.2886, time 15.93ms, mfu 0.29%
iter 250: loss 5.1571, time 20.27ms, mfu 0.30%
iter 260: loss 5.0064, time 27.06ms, mfu 0.29%
iter 270: loss 5.2312, time 17.46ms, mfu 0.30%
iter 280: loss 4.9733, time 28.06ms, mfu 0.29%
iter 290: loss 5.2019, time 20.14ms, mfu 0.29%
step 300: train loss 5.0942, val loss 5.3335
saving checkpoint to out-spectral
iter 300: loss 5.1226, time 2516.44ms, mfu 0.26%
iter 310: loss 5.1065, time 20.33ms, mfu 0.27%
iter 320: loss 4.9974, time 27.87ms, mfu 0.26%
iter 330: loss 5.1257, time 18.18ms, mfu 0.27%
iter 340: loss 5.0006, time 23.98ms, mfu 0.27%
iter 350: loss 4.9205, time 22.47ms, mfu 0.27%
iter 360: loss 4.9332, time 30.94ms, mfu 0.26%
iter 370: loss 4.8771, time 18.72ms, mfu 0.27%
iter 380: loss 4.9843, time 25.94ms, mfu 0.27%
iter 390: loss 4.7392, time 21.05ms, mfu 0.27%
step 400: train loss 4.8428, val loss 5.1968
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 400 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 400
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011713
Analysis data saved to out-spectral/20250519_011713/20250519_011713_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_011713/20250519_011713_analysis_data.h5
iter 400: loss 4.8909, time 3969.37ms, mfu 0.24%
iter 410: loss 4.8330, time 23.94ms, mfu 0.24%
iter 420: loss 4.8227, time 20.37ms, mfu 0.25%
iter 430: loss 4.4912, time 13.64ms, mfu 0.27%
iter 440: loss 4.7797, time 23.13ms, mfu 0.27%
iter 450: loss 4.7694, time 21.60ms, mfu 0.27%
iter 460: loss 4.9035, time 26.75ms, mfu 0.27%
iter 470: loss 4.7257, time 23.55ms, mfu 0.27%
iter 480: loss 4.3585, time 26.38ms, mfu 0.26%
iter 490: loss 4.7077, time 18.48ms, mfu 0.27%
step 500: train loss 4.6854, val loss 5.1377
saving checkpoint to out-spectral
iter 500: loss 4.4611, time 2445.09ms, mfu 0.24%
iter 510: loss 4.7743, time 30.64ms, mfu 0.24%
iter 520: loss 4.7544, time 29.35ms, mfu 0.24%
iter 530: loss 4.5538, time 20.90ms, mfu 0.24%
iter 540: loss 4.7241, time 28.55ms, mfu 0.24%
iter 550: loss 4.6102, time 21.57ms, mfu 0.25%
iter 560: loss 4.6046, time 28.85ms, mfu 0.24%
iter 570: loss 4.6287, time 19.62ms, mfu 0.25%
iter 580: loss 4.5684, time 30.59ms, mfu 0.24%
iter 590: loss 4.4864, time 24.32ms, mfu 0.25%
step 600: train loss 4.5355, val loss 5.0813
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 600 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 600
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011724
Analysis data saved to out-spectral/20250519_011724/20250519_011724_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_011724/20250519_011724_analysis_data.h5
iter 600: loss 4.6265, time 3757.90ms, mfu 0.22%
iter 610: loss 4.5468, time 22.82ms, mfu 0.23%
iter 620: loss 4.4413, time 20.77ms, mfu 0.23%
iter 630: loss 4.7987, time 23.45ms, mfu 0.24%
iter 640: loss 4.5690, time 19.86ms, mfu 0.24%
iter 650: loss 4.4601, time 23.40ms, mfu 0.25%
iter 660: loss 4.5423, time 48.52ms, mfu 0.23%
iter 670: loss 4.4157, time 29.12ms, mfu 0.23%
iter 680: loss 4.4972, time 18.88ms, mfu 0.24%
iter 690: loss 4.5236, time 22.57ms, mfu 0.25%
step 700: train loss 4.4302, val loss 5.0758
saving checkpoint to out-spectral
iter 700: loss 4.4364, time 2494.13ms, mfu 0.22%
iter 710: loss 4.2291, time 23.01ms, mfu 0.23%
iter 720: loss 4.3609, time 19.10ms, mfu 0.24%
iter 730: loss 4.2909, time 24.01ms, mfu 0.24%
iter 740: loss 4.3008, time 17.49ms, mfu 0.25%
iter 750: loss 4.4548, time 22.81ms, mfu 0.25%
iter 760: loss 4.1411, time 17.66ms, mfu 0.26%
iter 770: loss 4.2528, time 29.12ms, mfu 0.26%
iter 780: loss 4.4160, time 23.50ms, mfu 0.26%
iter 790: loss 4.3904, time 19.57ms, mfu 0.26%
step 800: train loss 4.3180, val loss 4.9979
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 800 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 800
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011735
Analysis data saved to out-spectral/20250519_011735/20250519_011735_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_011735/20250519_011735_analysis_data.h5
iter 800: loss 4.3618, time 3986.57ms, mfu 0.24%
iter 810: loss 4.4333, time 18.96ms, mfu 0.25%
iter 820: loss 4.2331, time 23.60ms, mfu 0.25%
iter 830: loss 4.3657, time 18.34ms, mfu 0.26%
iter 840: loss 4.6009, time 25.51ms, mfu 0.26%
iter 850: loss 4.2487, time 18.20ms, mfu 0.26%
iter 860: loss 4.0179, time 20.55ms, mfu 0.27%
iter 870: loss 4.2260, time 19.52ms, mfu 0.27%
iter 880: loss 4.3010, time 25.41ms, mfu 0.27%
iter 890: loss 4.1722, time 16.04ms, mfu 0.28%
step 900: train loss 4.2418, val loss 5.0032
saving checkpoint to out-spectral
iter 900: loss 4.4366, time 2270.36ms, mfu 0.25%
iter 910: loss 4.1343, time 24.29ms, mfu 0.25%
iter 920: loss 4.0714, time 19.23ms, mfu 0.26%
iter 930: loss 4.2552, time 17.62ms, mfu 0.27%
iter 940: loss 4.0790, time 22.27ms, mfu 0.27%
iter 950: loss 4.3084, time 18.69ms, mfu 0.28%
iter 960: loss 4.2401, time 21.77ms, mfu 0.28%
iter 970: loss 4.0291, time 30.56ms, mfu 0.27%
iter 980: loss 4.1539, time 27.62ms, mfu 0.27%
iter 990: loss 4.1897, time 24.59ms, mfu 0.26%
step 1000: train loss 4.1645, val loss 4.9981
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 1000 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 1000
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011746
Analysis data saved to out-spectral/20250519_011746/20250519_011746_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_011746/20250519_011746_analysis_data.h5
iter 1000: loss 4.2021, time 3713.72ms, mfu 0.24%
iter 1010: loss 4.3366, time 20.86ms, mfu 0.24%
iter 1020: loss 4.1950, time 21.14ms, mfu 0.25%
iter 1030: loss 4.1162, time 20.72ms, mfu 0.25%
iter 1040: loss 4.2562, time 16.49ms, mfu 0.27%
iter 1050: loss 4.0456, time 29.12ms, mfu 0.26%
iter 1060: loss 4.2506, time 25.55ms, mfu 0.26%
iter 1070: loss 4.3501, time 22.14ms, mfu 0.26%
iter 1080: loss 4.0468, time 24.97ms, mfu 0.26%
iter 1090: loss 4.1193, time 17.61ms, mfu 0.27%
step 1100: train loss 4.0661, val loss 4.9900
saving checkpoint to out-spectral
iter 1100: loss 4.1173, time 2278.32ms, mfu 0.24%
iter 1110: loss 3.9892, time 31.02ms, mfu 0.24%
iter 1120: loss 4.1385, time 24.84ms, mfu 0.24%
iter 1130: loss 4.0356, time 23.56ms, mfu 0.24%
iter 1140: loss 3.8834, time 21.06ms, mfu 0.25%
iter 1150: loss 4.0283, time 27.66ms, mfu 0.24%
iter 1160: loss 4.0064, time 19.10ms, mfu 0.25%
iter 1170: loss 4.1335, time 22.82ms, mfu 0.25%
iter 1180: loss 3.9843, time 18.89ms, mfu 0.26%
iter 1190: loss 3.9760, time 20.17ms, mfu 0.27%
step 1200: train loss 3.9918, val loss 4.9548
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 1200 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 1200
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011756
Analysis data saved to out-spectral/20250519_011756/20250519_011756_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_011756/20250519_011756_analysis_data.h5
iter 1200: loss 3.9929, time 3611.39ms, mfu 0.24%
iter 1210: loss 3.8886, time 19.30ms, mfu 0.25%
iter 1220: loss 3.8136, time 19.08ms, mfu 0.26%
iter 1230: loss 4.0501, time 27.93ms, mfu 0.25%
iter 1240: loss 4.1580, time 21.25ms, mfu 0.26%
iter 1250: loss 4.0576, time 23.71ms, mfu 0.26%
iter 1260: loss 4.0667, time 24.52ms, mfu 0.26%
iter 1270: loss 3.8056, time 20.70ms, mfu 0.26%
iter 1280: loss 4.1419, time 26.14ms, mfu 0.26%
iter 1290: loss 3.8716, time 28.20ms, mfu 0.25%
step 1300: train loss 3.8819, val loss 4.9927
saving checkpoint to out-spectral
iter 1300: loss 4.0183, time 2326.56ms, mfu 0.23%
iter 1310: loss 3.7914, time 24.35ms, mfu 0.23%
iter 1320: loss 3.9154, time 19.91ms, mfu 0.24%
iter 1330: loss 3.6509, time 20.57ms, mfu 0.25%
iter 1340: loss 3.9870, time 19.15ms, mfu 0.25%
iter 1350: loss 3.8814, time 21.77ms, mfu 0.26%
iter 1360: loss 3.8922, time 28.04ms, mfu 0.25%
iter 1370: loss 3.7430, time 18.98ms, mfu 0.26%
iter 1380: loss 3.7144, time 20.87ms, mfu 0.26%
iter 1390: loss 3.8967, time 31.70ms, mfu 0.26%
step 1400: train loss 3.8233, val loss 5.0098
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 1400 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 1400
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011807
Analysis data saved to out-spectral/20250519_011807/20250519_011807_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_011807/20250519_011807_analysis_data.h5
iter 1400: loss 3.7399, time 3478.56ms, mfu 0.23%
iter 1410: loss 3.8503, time 25.71ms, mfu 0.23%
iter 1420: loss 3.7258, time 23.32ms, mfu 0.24%
iter 1430: loss 3.7224, time 35.36ms, mfu 0.23%
iter 1440: loss 3.8737, time 19.23ms, mfu 0.24%
iter 1450: loss 3.8719, time 22.48ms, mfu 0.24%
iter 1460: loss 3.9589, time 20.14ms, mfu 0.25%
iter 1470: loss 3.8424, time 20.92ms, mfu 0.25%
iter 1480: loss 3.8297, time 23.84ms, mfu 0.25%
iter 1490: loss 3.9069, time 33.32ms, mfu 0.25%
step 1500: train loss 3.7779, val loss 5.0029
saving checkpoint to out-spectral
iter 1500: loss 3.6551, time 2492.11ms, mfu 0.22%
iter 1510: loss 3.7998, time 25.36ms, mfu 0.23%
iter 1520: loss 3.7661, time 21.43ms, mfu 0.23%
iter 1530: loss 3.5751, time 17.81ms, mfu 0.24%
iter 1540: loss 3.9469, time 32.46ms, mfu 0.24%
iter 1550: loss 3.7656, time 21.77ms, mfu 0.24%
iter 1560: loss 3.7874, time 20.38ms, mfu 0.25%
iter 1570: loss 3.5496, time 17.38ms, mfu 0.26%
iter 1580: loss 3.6644, time 21.66ms, mfu 0.26%
iter 1590: loss 3.6196, time 19.01ms, mfu 0.27%
step 1600: train loss 3.7239, val loss 5.0084
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 1600 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 1600
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011818
Analysis data saved to out-spectral/20250519_011818/20250519_011818_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_011818/20250519_011818_analysis_data.h5
iter 1600: loss 3.6085, time 3627.47ms, mfu 0.24%
iter 1610: loss 3.6405, time 17.03ms, mfu 0.25%
iter 1620: loss 3.7058, time 32.94ms, mfu 0.25%
iter 1630: loss 3.6396, time 23.31ms, mfu 0.25%
iter 1640: loss 3.7300, time 22.08ms, mfu 0.25%
iter 1650: loss 3.5263, time 17.58ms, mfu 0.26%
iter 1660: loss 3.8201, time 25.48ms, mfu 0.26%
iter 1670: loss 3.5478, time 42.03ms, mfu 0.25%
iter 1680: loss 3.7779, time 28.06ms, mfu 0.25%
iter 1690: loss 3.6734, time 30.15ms, mfu 0.24%
step 1700: train loss 3.6850, val loss 5.0377
saving checkpoint to out-spectral
iter 1700: loss 3.5695, time 2508.99ms, mfu 0.22%
iter 1710: loss 3.8219, time 19.17ms, mfu 0.23%
iter 1720: loss 3.7806, time 18.78ms, mfu 0.24%
iter 1730: loss 3.5809, time 28.63ms, mfu 0.24%
iter 1740: loss 3.7053, time 21.03ms, mfu 0.24%
iter 1750: loss 3.6303, time 21.82ms, mfu 0.25%
iter 1760: loss 3.7432, time 22.96ms, mfu 0.25%
iter 1770: loss 3.6892, time 24.97ms, mfu 0.25%
iter 1780: loss 3.6986, time 38.11ms, mfu 0.24%
iter 1790: loss 3.5020, time 20.42ms, mfu 0.25%
step 1800: train loss 3.6651, val loss 5.0277
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 1800 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 1800
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011829
Analysis data saved to out-spectral/20250519_011829/20250519_011829_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_011829/20250519_011829_analysis_data.h5
iter 1800: loss 3.8099, time 3754.77ms, mfu 0.22%
iter 1810: loss 3.6866, time 20.18ms, mfu 0.23%
iter 1820: loss 3.3768, time 15.11ms, mfu 0.25%
iter 1830: loss 3.8204, time 17.07ms, mfu 0.26%
iter 1840: loss 3.6342, time 25.75ms, mfu 0.26%
iter 1850: loss 3.6111, time 16.89ms, mfu 0.27%
iter 1860: loss 3.6486, time 14.36ms, mfu 0.29%
iter 1870: loss 3.5762, time 19.37ms, mfu 0.29%
iter 1880: loss 3.7323, time 20.28ms, mfu 0.29%
iter 1890: loss 3.4761, time 19.22ms, mfu 0.29%
step 1900: train loss 3.5923, val loss 5.0303
saving checkpoint to out-spectral
iter 1900: loss 3.6679, time 2469.17ms, mfu 0.26%
iter 1910: loss 3.5291, time 24.72ms, mfu 0.26%
iter 1920: loss 3.3217, time 32.00ms, mfu 0.26%
iter 1930: loss 3.4805, time 20.70ms, mfu 0.26%
iter 1940: loss 3.5043, time 22.74ms, mfu 0.26%
iter 1950: loss 3.5800, time 27.89ms, mfu 0.26%
iter 1960: loss 3.7136, time 43.30ms, mfu 0.25%
iter 1970: loss 3.5815, time 20.68ms, mfu 0.25%
iter 1980: loss 3.4207, time 29.28ms, mfu 0.25%
iter 1990: loss 3.5227, time 20.11ms, mfu 0.25%
Saving final spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_011836_final
Analysis data saved to out-spectral/20250519_011836_final/20250519_011836_final_analysis_data.h5
Saved final spectral analysis data in HDF5 format to: out-spectral/20250519_011836_final/20250519_011836_final_analysis_data.h5
saving final checkpoint to out-spectral

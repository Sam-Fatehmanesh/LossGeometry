step 0: train loss 10.8634, val loss 10.8635

--- Performing spectral analysis at iteration 0 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 0
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_012910
Analysis data saved to out-spectral/20250519_012910/20250519_012910_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_012910/20250519_012910_analysis_data.h5

--- Performing initial spectral analysis ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Completed initial spectral analysis
iter 0: loss 10.8637, time 4572.62ms, mfu -100.00%
iter 10: loss 10.5782, time 19.97ms, mfu 0.31%
iter 20: loss 10.2702, time 23.01ms, mfu 0.31%
iter 30: loss 10.0823, time 17.23ms, mfu 0.31%
iter 40: loss 9.7521, time 14.66ms, mfu 0.32%
iter 50: loss 9.3295, time 13.06ms, mfu 0.34%
iter 60: loss 8.8852, time 15.29ms, mfu 0.34%
iter 70: loss 8.3314, time 25.77ms, mfu 0.33%
iter 80: loss 7.8119, time 41.00ms, mfu 0.32%
iter 90: loss 7.3693, time 15.52ms, mfu 0.32%
step 100: train loss 7.0041, val loss 7.0382
saving checkpoint to out-spectral
iter 100: loss 7.0620, time 2425.06ms, mfu 0.29%
iter 110: loss 6.8228, time 24.99ms, mfu 0.29%
iter 120: loss 6.4933, time 26.20ms, mfu 0.28%
iter 130: loss 6.4354, time 26.68ms, mfu 0.28%
iter 140: loss 6.1686, time 25.37ms, mfu 0.27%
iter 150: loss 6.0850, time 32.25ms, mfu 0.27%
iter 160: loss 5.9227, time 23.48ms, mfu 0.27%
iter 170: loss 5.8624, time 22.93ms, mfu 0.27%
iter 180: loss 5.8246, time 17.67ms, mfu 0.27%
iter 190: loss 5.5763, time 18.40ms, mfu 0.28%
step 200: train loss 5.5584, val loss 5.6864
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 200 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 200
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_012921
Analysis data saved to out-spectral/20250519_012921/20250519_012921_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_012921/20250519_012921_analysis_data.h5
iter 200: loss 5.6011, time 3681.31ms, mfu 0.25%
iter 210: loss 5.4578, time 29.11ms, mfu 0.25%
iter 220: loss 5.3545, time 18.24ms, mfu 0.26%
iter 230: loss 5.4936, time 21.62ms, mfu 0.26%
iter 240: loss 5.2886, time 25.37ms, mfu 0.26%
iter 250: loss 5.1571, time 26.22ms, mfu 0.26%
iter 260: loss 5.0064, time 31.05ms, mfu 0.25%
iter 270: loss 5.2312, time 20.87ms, mfu 0.26%
iter 280: loss 4.9733, time 19.19ms, mfu 0.26%
iter 290: loss 5.2019, time 18.15ms, mfu 0.27%
step 300: train loss 5.0942, val loss 5.3335
saving checkpoint to out-spectral
iter 300: loss 5.1226, time 2752.74ms, mfu 0.24%
iter 310: loss 5.1065, time 17.88ms, mfu 0.25%
iter 320: loss 4.9974, time 21.31ms, mfu 0.26%
iter 330: loss 5.1257, time 36.68ms, mfu 0.25%
iter 340: loss 5.0006, time 24.35ms, mfu 0.25%
iter 350: loss 4.9205, time 18.11ms, mfu 0.26%
iter 360: loss 4.9332, time 18.01ms, mfu 0.27%
iter 370: loss 4.8771, time 21.98ms, mfu 0.27%
iter 380: loss 4.9843, time 16.86ms, mfu 0.28%
iter 390: loss 4.7392, time 19.82ms, mfu 0.28%
step 400: train loss 4.8428, val loss 5.1968
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 400 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 400
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_012932
Analysis data saved to out-spectral/20250519_012932/20250519_012932_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_012932/20250519_012932_analysis_data.h5
iter 400: loss 4.8909, time 3482.74ms, mfu 0.25%
iter 410: loss 4.8330, time 25.24ms, mfu 0.25%
iter 420: loss 4.8227, time 21.57ms, mfu 0.26%
iter 430: loss 4.4912, time 27.08ms, mfu 0.25%
iter 440: loss 4.7797, time 19.12ms, mfu 0.26%
iter 450: loss 4.7694, time 17.76ms, mfu 0.27%
iter 460: loss 4.9035, time 17.78ms, mfu 0.28%
iter 470: loss 4.7257, time 19.79ms, mfu 0.28%
iter 480: loss 4.3585, time 19.33ms, mfu 0.28%
iter 490: loss 4.7077, time 21.38ms, mfu 0.29%
step 500: train loss 4.6854, val loss 5.1377
saving checkpoint to out-spectral
iter 500: loss 4.4611, time 2667.40ms, mfu 0.26%
iter 510: loss 4.7743, time 21.18ms, mfu 0.26%
iter 520: loss 4.7544, time 29.20ms, mfu 0.26%
iter 530: loss 4.5538, time 19.70ms, mfu 0.26%
iter 540: loss 4.7241, time 18.28ms, mfu 0.27%
iter 550: loss 4.6102, time 19.27ms, mfu 0.27%
iter 560: loss 4.6046, time 23.88ms, mfu 0.27%
iter 570: loss 4.6287, time 18.05ms, mfu 0.28%
iter 580: loss 4.5684, time 26.52ms, mfu 0.28%
iter 590: loss 4.4864, time 18.17ms, mfu 0.28%
step 600: train loss 4.5355, val loss 5.0813
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 600 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 600
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_012943
Analysis data saved to out-spectral/20250519_012943/20250519_012943_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_012943/20250519_012943_analysis_data.h5
iter 600: loss 4.6265, time 3880.18ms, mfu 0.25%
iter 610: loss 4.5468, time 17.11ms, mfu 0.26%
iter 620: loss 4.4413, time 17.85ms, mfu 0.27%
iter 630: loss 4.7987, time 17.40ms, mfu 0.28%
iter 640: loss 4.5690, time 17.36ms, mfu 0.29%
iter 650: loss 4.4601, time 18.11ms, mfu 0.29%
iter 660: loss 4.5423, time 18.07ms, mfu 0.30%
iter 670: loss 4.4157, time 25.10ms, mfu 0.29%
iter 680: loss 4.4972, time 19.92ms, mfu 0.30%
iter 690: loss 4.5236, time 34.51ms, mfu 0.28%
step 700: train loss 4.4302, val loss 5.0758
saving checkpoint to out-spectral
iter 700: loss 4.4364, time 2637.00ms, mfu 0.26%
iter 710: loss 4.2291, time 29.73ms, mfu 0.25%
iter 720: loss 4.3609, time 17.44ms, mfu 0.26%
iter 730: loss 4.2909, time 17.79ms, mfu 0.27%
iter 740: loss 4.3008, time 24.71ms, mfu 0.27%
iter 750: loss 4.4548, time 21.26ms, mfu 0.27%
iter 760: loss 4.1411, time 25.59ms, mfu 0.27%
iter 770: loss 4.2528, time 21.77ms, mfu 0.27%
iter 780: loss 4.4160, time 21.69ms, mfu 0.27%
iter 790: loss 4.3904, time 17.81ms, mfu 0.28%
step 800: train loss 4.3180, val loss 4.9979
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 800 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 800
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_012953
Analysis data saved to out-spectral/20250519_012953/20250519_012953_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_012953/20250519_012953_analysis_data.h5
iter 800: loss 4.3618, time 3490.64ms, mfu 0.25%
iter 810: loss 4.4333, time 18.06ms, mfu 0.26%
iter 820: loss 4.2331, time 22.77ms, mfu 0.26%
iter 830: loss 4.3657, time 17.26ms, mfu 0.27%
iter 840: loss 4.6009, time 18.19ms, mfu 0.28%
iter 850: loss 4.2487, time 19.82ms, mfu 0.28%
iter 860: loss 4.0179, time 30.01ms, mfu 0.27%
iter 870: loss 4.2260, time 25.12ms, mfu 0.27%
iter 880: loss 4.3010, time 20.51ms, mfu 0.27%
iter 890: loss 4.1722, time 52.23ms, mfu 0.26%
step 900: train loss 4.2418, val loss 5.0032
saving checkpoint to out-spectral
iter 900: loss 4.4366, time 2581.13ms, mfu 0.23%
iter 910: loss 4.1343, time 18.10ms, mfu 0.24%
iter 920: loss 4.0714, time 17.87ms, mfu 0.25%
iter 930: loss 4.2552, time 17.65ms, mfu 0.26%
iter 940: loss 4.0790, time 20.11ms, mfu 0.27%
iter 950: loss 4.3084, time 19.93ms, mfu 0.27%
iter 960: loss 4.2401, time 34.29ms, mfu 0.26%
iter 970: loss 4.0291, time 36.61ms, mfu 0.25%
iter 980: loss 4.1539, time 20.03ms, mfu 0.26%
iter 990: loss 4.1897, time 19.99ms, mfu 0.26%
step 1000: train loss 4.1645, val loss 4.9981
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 1000 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 1000
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_013004
Analysis data saved to out-spectral/20250519_013004/20250519_013004_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_013004/20250519_013004_analysis_data.h5
iter 1000: loss 4.2021, time 3719.21ms, mfu 0.24%
iter 1010: loss 4.3366, time 22.97ms, mfu 0.24%
iter 1020: loss 4.1950, time 25.93ms, mfu 0.24%
iter 1030: loss 4.1162, time 20.61ms, mfu 0.25%
iter 1040: loss 4.2562, time 28.26ms, mfu 0.24%
iter 1050: loss 4.0456, time 31.14ms, mfu 0.24%
iter 1060: loss 4.2506, time 17.68ms, mfu 0.25%
iter 1070: loss 4.3501, time 24.75ms, mfu 0.25%
iter 1080: loss 4.0468, time 21.46ms, mfu 0.25%
iter 1090: loss 4.1193, time 17.70ms, mfu 0.26%
step 1100: train loss 4.0661, val loss 4.9900
saving checkpoint to out-spectral
iter 1100: loss 4.1173, time 2769.27ms, mfu 0.24%
iter 1110: loss 3.9892, time 18.94ms, mfu 0.25%
iter 1120: loss 4.1385, time 17.83ms, mfu 0.26%
iter 1130: loss 4.0356, time 26.32ms, mfu 0.25%
iter 1140: loss 3.8834, time 21.20ms, mfu 0.26%
iter 1150: loss 4.0283, time 31.11ms, mfu 0.25%
iter 1160: loss 4.0064, time 25.06ms, mfu 0.25%
iter 1170: loss 4.1335, time 22.86ms, mfu 0.25%
iter 1180: loss 3.9843, time 22.52ms, mfu 0.26%
iter 1190: loss 3.9760, time 22.45ms, mfu 0.26%
step 1200: train loss 3.9918, val loss 4.9548
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 1200 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 1200
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_013015
Analysis data saved to out-spectral/20250519_013015/20250519_013015_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_013015/20250519_013015_analysis_data.h5
iter 1200: loss 3.9929, time 3617.46ms, mfu 0.23%
iter 1210: loss 3.8886, time 18.82ms, mfu 0.24%
iter 1220: loss 3.8136, time 18.77ms, mfu 0.25%
iter 1230: loss 4.0501, time 27.38ms, mfu 0.25%
iter 1240: loss 4.1580, time 23.20ms, mfu 0.25%
iter 1250: loss 4.0576, time 23.05ms, mfu 0.25%
iter 1260: loss 4.0667, time 26.55ms, mfu 0.25%
iter 1270: loss 3.8056, time 18.55ms, mfu 0.26%
iter 1280: loss 4.1419, time 20.40ms, mfu 0.26%
iter 1290: loss 3.8716, time 17.60ms, mfu 0.27%
step 1300: train loss 3.8819, val loss 4.9927
saving checkpoint to out-spectral
iter 1300: loss 4.0183, time 2267.71ms, mfu 0.25%
iter 1310: loss 3.7914, time 32.76ms, mfu 0.24%
iter 1320: loss 3.9154, time 19.05ms, mfu 0.25%
iter 1330: loss 3.6509, time 20.17ms, mfu 0.25%
iter 1340: loss 3.9870, time 23.18ms, mfu 0.26%
iter 1350: loss 3.8814, time 27.32ms, mfu 0.25%
iter 1360: loss 3.8922, time 17.49ms, mfu 0.26%
iter 1370: loss 3.7430, time 21.78ms, mfu 0.26%
iter 1380: loss 3.7144, time 20.50ms, mfu 0.27%
iter 1390: loss 3.8967, time 18.59ms, mfu 0.27%
step 1400: train loss 3.8233, val loss 5.0098
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 1400 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 1400
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_013025
Analysis data saved to out-spectral/20250519_013025/20250519_013025_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_013025/20250519_013025_analysis_data.h5
iter 1400: loss 3.7399, time 3880.24ms, mfu 0.25%
iter 1410: loss 3.8503, time 20.36ms, mfu 0.25%
iter 1420: loss 3.7258, time 21.06ms, mfu 0.26%
iter 1430: loss 3.7224, time 17.41ms, mfu 0.27%
iter 1440: loss 3.8737, time 22.22ms, mfu 0.27%
iter 1450: loss 3.8719, time 27.24ms, mfu 0.26%
iter 1460: loss 3.9589, time 18.33ms, mfu 0.27%
iter 1470: loss 3.8424, time 23.21ms, mfu 0.27%
iter 1480: loss 3.8297, time 28.05ms, mfu 0.27%
iter 1490: loss 3.9069, time 21.28ms, mfu 0.27%
step 1500: train loss 3.7779, val loss 5.0029
saving checkpoint to out-spectral
iter 1500: loss 3.6551, time 2311.06ms, mfu 0.24%
iter 1510: loss 3.7998, time 20.84ms, mfu 0.25%
iter 1520: loss 3.7661, time 26.31ms, mfu 0.25%
iter 1530: loss 3.5751, time 32.11ms, mfu 0.24%
iter 1540: loss 3.9469, time 17.46ms, mfu 0.25%
iter 1550: loss 3.7656, time 17.62ms, mfu 0.26%
iter 1560: loss 3.7874, time 19.96ms, mfu 0.27%
iter 1570: loss 3.5496, time 20.35ms, mfu 0.27%
iter 1580: loss 3.6644, time 18.38ms, mfu 0.28%
iter 1590: loss 3.6196, time 25.18ms, mfu 0.27%
step 1600: train loss 3.7239, val loss 5.0084
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 1600 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 1600
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_013036
Analysis data saved to out-spectral/20250519_013036/20250519_013036_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_013036/20250519_013036_analysis_data.h5
iter 1600: loss 3.6085, time 3563.45ms, mfu 0.25%
iter 1610: loss 3.6405, time 33.38ms, mfu 0.24%
iter 1620: loss 3.7058, time 29.55ms, mfu 0.24%
iter 1630: loss 3.6396, time 22.29ms, mfu 0.24%
iter 1640: loss 3.7300, time 18.17ms, mfu 0.25%
iter 1650: loss 3.5263, time 21.54ms, mfu 0.26%
iter 1660: loss 3.8201, time 26.07ms, mfu 0.25%
iter 1670: loss 3.5478, time 17.73ms, mfu 0.26%
iter 1680: loss 3.7779, time 20.99ms, mfu 0.27%
iter 1690: loss 3.6734, time 23.75ms, mfu 0.27%
step 1700: train loss 3.6850, val loss 5.0377
saving checkpoint to out-spectral
iter 1700: loss 3.5695, time 2442.56ms, mfu 0.24%
iter 1710: loss 3.8219, time 25.66ms, mfu 0.24%
iter 1720: loss 3.7806, time 25.14ms, mfu 0.24%
iter 1730: loss 3.5809, time 24.36ms, mfu 0.24%
iter 1740: loss 3.7053, time 19.17ms, mfu 0.25%
iter 1750: loss 3.6303, time 27.26ms, mfu 0.25%
iter 1760: loss 3.7432, time 20.51ms, mfu 0.25%
iter 1770: loss 3.6892, time 22.49ms, mfu 0.26%
iter 1780: loss 3.6986, time 19.02ms, mfu 0.26%
iter 1790: loss 3.5020, time 22.30ms, mfu 0.26%
step 1800: train loss 3.6651, val loss 5.0277
saving checkpoint to out-spectral

--- Performing spectral analysis at iteration 1800 ---
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.0.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.0.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.0.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.1.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.1.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.1.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.2.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.2.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.2.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.attn.c_attn.weight of shape torch.Size([768, 256]).
  Calculated 256 normalized singular values for transformer.h.3.attn.c_attn.weight.
  Calculated 256 normalized eigenvalues for transformer.h.3.attn.c_proj.weight.
  Calculated 256 normalized singular values for transformer.h.3.attn.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.0.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.0.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.1.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.1.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.2.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.2.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_fc.weight of shape torch.Size([1024, 256]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_fc.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.h.3.mlp.c_proj.weight of shape torch.Size([256, 1024]).
  Calculated 256 normalized singular values for transformer.h.3.mlp.c_proj.weight.
  Skipping eigenvalue analysis for non-square matrix transformer.wte.weight of shape torch.Size([50257, 256]).
  Calculated 256 normalized singular values for transformer.wte.weight.
Recorded spectral analysis data for iteration 1800
Saving spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_013046
Analysis data saved to out-spectral/20250519_013046/20250519_013046_analysis_data.h5
Saved spectral analysis data in HDF5 format to: out-spectral/20250519_013046/20250519_013046_analysis_data.h5
iter 1800: loss 3.8099, time 3495.23ms, mfu 0.24%
iter 1810: loss 3.6866, time 21.04ms, mfu 0.24%
iter 1820: loss 3.3768, time 24.65ms, mfu 0.24%
iter 1830: loss 3.8204, time 29.78ms, mfu 0.24%
iter 1840: loss 3.6342, time 22.36ms, mfu 0.24%
iter 1850: loss 3.6111, time 20.30ms, mfu 0.25%
iter 1860: loss 3.6486, time 20.29ms, mfu 0.26%
iter 1870: loss 3.5762, time 21.91ms, mfu 0.26%
iter 1880: loss 3.7323, time 21.04ms, mfu 0.26%
iter 1890: loss 3.4761, time 20.82ms, mfu 0.27%
step 1900: train loss 3.5923, val loss 5.0303
saving checkpoint to out-spectral
iter 1900: loss 3.6679, time 2505.09ms, mfu 0.24%
iter 1910: loss 3.5291, time 20.04ms, mfu 0.25%
iter 1920: loss 3.3217, time 25.15ms, mfu 0.25%
iter 1930: loss 3.4805, time 27.81ms, mfu 0.24%
iter 1940: loss 3.5043, time 28.22ms, mfu 0.24%
iter 1950: loss 3.5800, time 23.75ms, mfu 0.24%
iter 1960: loss 3.7136, time 17.74ms, mfu 0.25%
iter 1970: loss 3.5815, time 17.36ms, mfu 0.26%
iter 1980: loss 3.4207, time 17.57ms, mfu 0.27%
iter 1990: loss 3.5227, time 18.10ms, mfu 0.28%
Saving final spectral analysis data to out-spectral/spectral
Created experiment directory: out-spectral/20250519_013053_final
Analysis data saved to out-spectral/20250519_013053_final/20250519_013053_final_analysis_data.h5
Saved final spectral analysis data in HDF5 format to: out-spectral/20250519_013053_final/20250519_013053_final_analysis_data.h5
saving final checkpoint to out-spectral
